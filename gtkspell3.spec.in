%global enable_gtk2 @SPEC_ENABLE_GTK2@
%global enable_gtkdoc @SPEC_ENABLE_GTK_DOC@

Name: gtkspell3
Version: 3.@GTK_SPELL_VERSION_MINOR@.@GTK_SPELL_VERSION_MICRO@
Release: 1%{?dist}
License: GPLv2+
Group: System Environment/Libraries
Summary: On-the-fly spell checking for GtkTextView widgets
URL: http://gtkspell.sourceforge.net/
Source: %{name}-%{version}.tar.xz

BuildRequires: enchant-devel
BuildRequires: gtk3-devel
BuildRequires: gobject-introspection-devel
BuildRequires: intltool
BuildRequires: libtool
%{?enable_gtkdoc:BuildRequires: gtk-doc}
%{?enable_gtk2:BuildRequires: gtk2-devel}

%description
GtkSpell provides word-processor-style highlighting and replacement of 
misspelled words in a GtkTextView widget as you type. Right-clicking a
misspelled word pops up a menu of suggested replacements.

%package devel
Group: Development/Libraries
Summary: Development files for GtkSpell
Requires: %{name} = %{version}-%{release}
Requires: gtk3-devel
Requires: pkgconfig

%description devel
The gtkspell-devel package provides header files for developing GTK+3
applications which use GtkSpell.

%if 0%{enable_gtk2} == 1
%package gtk2
Group: System Environment/Libraries
Summary: GtkSpell for GTK+2

%description gtk2
GtkSpell compiled for use with GTK+2

%package gtk2-devel
Group: Development/Libraries
Summary: Development files for GtkSpell for GTK+2
Requires: %{name}-devel = %{version}-%{release}
Requires: %{name}-gtk2 = %{version}-%{release}
Requires: gtk2-devel
Requires: pkgconfig

%description gtk2-devel
The gtkspell-gtk2-devel package provides header files for developing GTK+2
applications which use GtkSpell.
%endif

%prep
%setup -q

%build
%configure --disable-static \
	%{?enable_gtkdoc:--enable-gtk-doc} \
	%{?enable_gtk2:--enable-gtk2}

make %{?_smp_mflags}

%install
make DESTDIR=$RPM_BUILD_ROOT install
find $RPM_BUILD_ROOT -name "*.la" -exec rm {} \;

%find_lang %{name}

%post -p /sbin/ldconfig

%postun -p /sbin/ldconfig

%files -f %{name}.lang
%defattr(-,root,root,-)
%doc AUTHORS ChangeLog COPYING README
%{_libdir}/libgtkspell3-3.so.0*
%{_libdir}/girepository-1.0/GtkSpell-3.0.typelib

%files devel
%defattr(-,root,root,-)
%{?enable_gtkdoc:%{_datadir}/gtk-doc/html/gtkspell3}
%{_includedir}/gtkspell-3.0
%{_libdir}/libgtkspell3-3.so
%{_libdir}/pkgconfig/gtkspell3-3.0.pc
%{_datadir}/gir-1.0/GtkSpell-3.0.gir

%if 0%{enable_gtk2} == 1
%files gtk2
%{_libdir}/libgtkspell3-2.so.0*
%{_libdir}/girepository-1.0/GtkSpell-2.0.typelib

%files gtk2-devel
%defattr(-,root,root,-)
%{_libdir}/libgtkspell3-2.so
%{_libdir}/pkgconfig/gtkspell3-2.0.pc
%{_datadir}/gir-1.0/GtkSpell-2.0.gir
%endif

%changelog
* Thu Sep 06 2012 Sandro Mani <manisandro@gmail.com> - 3.@GTK_SPELL_VERSION_MINOR@.@GTK_SPELL_VERSION_MICRO@-1
- Initial package.
